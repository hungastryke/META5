package com.rimv.net {	import flash.events.*;	import com.webdevils.net.XMLLoader;	import com.webdevils.utils.Collection;	import com.rimv.net.PlayListSearch;	import flash.net.URLLoader ;	import flash.net.URLRequest ;//var playerSearch:PlayListSearch = new PlayListSearch();		public class Meta5dataSearch extends EventDispatcher {		private var _collection:Collection;		private var playerSearch:PlayListSearch = new PlayListSearch();		private var searchString:String ;		private var listLoader:URLLoader = new URLLoader();				public function Meta5dataSearch(_searchString:String) {						_collection = new Collection();			searchString = _searchString ;			if(searchString.length > 0){				var _xl = new XMLLoader( "functions.php" );				_xl.addEventListener( Event.COMPLETE, on_complete );			}		}				private function on_complete( e:Event ):void {			var item_xml = new XML( e.target.data );						//var _resultXml:XML = playerSearch.searchPlayList(searchString, item_xml) ;						item_xml = playerSearch.searchPlayList(searchString, item_xml) ;			//trace(searchString + "here") ;			item_xml = item_xml.item ;						for ( var p in item_xml ) {				// trace( "******** " +  item_xml[p].children()  );				var obj = make_obj_from_xml( item_xml[p].children() );								// trace( "------------------------------" );				var track_collection = new Collection();				var track_xml = item_xml[p].track_list.children();								for ( var q in track_xml ) {					var t = track_xml[q].children();					var track_obj = make_obj_from_xml( t );					track_collection.addElement( track_obj );				}								obj.track_list = track_collection;				_collection.addElement( obj );			}						dispatchEvent( new Event( Event.COMPLETE ) );		}				public function search_data(_searchString:String) {			_collection = new Collection();			searchString = _searchString ;			listLoader.load(new URLRequest("playlist.xml"));				listLoader.addEventListener(Event.COMPLETE, search_complete); 			//listLoader = new XMLLoader( "playlist.xml" );			//listLoader.addEventListener( Event.COMPLETE, search_complete );		}				private function search_complete( e:Event ):void {			var item_xml = new XML( listLoader.data );						//var _resultXml:XML = playerSearch.searchPlayList(searchString, item_xml) ;						item_xml = playerSearch.searchPlayList("Tribe", item_xml) ;			//trace(searchString + "here") ;			item_xml = item_xml.item ;			//var _resultXmlList:XMLList = _resultXml.item ;			for ( var p in item_xml ) {				// trace( "******** " +  item_xml[p].children()  );				var obj = make_obj_from_xml( item_xml[p].children() );								// trace( "------------------------------" );				var track_collection = new Collection();				var track_xml = item_xml[p].track_list.children();								for ( var q in track_xml ) {					var t = track_xml[q].children();					var track_obj = make_obj_from_xml( t );					track_collection.addElement( track_obj );				}								obj.track_list = track_collection;				_collection.addElement( obj );			}						dispatchEvent( new Event( Event.COMPLETE ) );		}				private function make_obj_from_xml( xml ):Object {			var obj = new Object();			for ( var p in xml ) {				// trace( xml[p].toString() );				obj[ xml[p].name() ] = xml[p].toString();			}			return obj;		}				// **************************************************************		// Public Functions 		public function getCollection():Collection {			return _collection;		}				public function getPlaylist( index:uint ):Object {			return _collection.getItem( index );		}				public function getTrackList( index:uint ):Collection {			return _collection.getItem( index ).track_list;		}					}}